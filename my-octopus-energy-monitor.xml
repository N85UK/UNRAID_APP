<?xml version="1.0"?>
<Container version="2">
  <Name>OctopusEnergyMonitor</Name>
  <Repository>ghcr.io/n85uk/octopus-energy-monitor:latest</Repository>
  <Registry>https://ghcr.io/n85uk/octopus-energy-monitor</Registry>
  <Network>bridge</Network>
  <MyIP/>
  <Shell>sh</Shell>
  <Privileged>false</Privileged>
  <Support>https://forums.unraid.net/topic/195211-support-n85uk-octopus-energy-monitor/</Support>
  <Project>https://github.com/N85UK/UNRAID_Apps/tree/main/Apps/Octopus_Energy_Monitor</Project>
  <Overview>
    Octopus Energy Monitor - Track your energy usage and costs in real-time.
    
    Features:
    - Automatic meter discovery from your Octopus account
    - Half-hourly electricity and gas consumption tracking
    - Automatic tariff rate fetching (Agile, Flexible, etc.)
    - Cost calculations per interval, day, week, month
    - Prometheus metrics at /metrics
    - Grafana-ready SQLite database
    - RESTful API for custom integrations
    - Optional GraphQL support for Home Mini real-time data
    
    Initial setup backfills 400 days of data. Incremental sync runs every 30 minutes.
  </Overview>
  <Category>Tools:Utilities</Category>
  <WebUI>http://[IP]:[PORT:8088]/docs</WebUI>
  <TemplateURL>https://raw.githubusercontent.com/N85UK/UNRAID_Apps/main/Apps/Octopus_Energy_Monitor/unraid/template.xml</TemplateURL>
  <Icon>https://raw.githubusercontent.com/N85UK/UNRAID_Apps/main/Apps/Octopus_Energy_Monitor/icon.png</Icon>
  <ExtraParams/>
  <PostArgs/>
  <CPUset/>
  <DateInstalled></DateInstalled>
  <DonateText/>
  <DonateLink/>
  <Requires/>
  <Config Name="Web UI Port" Target="8088" Default="8088" Mode="tcp" Description="HTTP port for API and web interface. Default is 8088. Do not use 9090 if you have Prometheus installed." Type="Port" Display="always" Required="true" Mask="false">8088</Config>
  <Config Name="Data Directory" Target="/data" Default="/mnt/user/appdata/octopus-energy-monitor" Mode="rw" Description="Persistent storage for SQLite database and application data" Type="Path" Display="always" Required="true" Mask="false">/mnt/user/appdata/octopus-energy-monitor</Config>
  
  <!-- Required Configuration -->
  <Config Name="Account Number" Target="OCTOPUS_ACCOUNT_NUMBER" Default="" Mode="" Description="Your Octopus Energy account number (format: A-1234ABCD)" Type="Variable" Display="always" Required="true" Mask="false"/>
  
  <!-- Authentication (choose one method) -->
  <Config Name="API Key" Target="OCTOPUS_API_KEY" Default="" Mode="" Description="Your Octopus API key (alternative: use Bearer Token)" Type="Variable" Display="always" Required="false" Mask="true"/>
  <Config Name="Bearer Token" Target="OCTOPUS_BEARER_TOKEN" Default="" Mode="" Description="Your Octopus bearer token (preferred auth method)" Type="Variable" Display="always" Required="false" Mask="true"/>
  <Config Name="Auth Mode" Target="OCTOPUS_AUTH_MODE" Default="bearer" Mode="" Description="Authentication mode: bearer (preferred) or basic" Type="Variable" Display="always" Required="true" Mask="false">bearer</Config>
  
  <!-- Optional: Meter Details (auto-discovered if not provided) -->
  <Config Name="MPAN" Target="MPAN" Default="" Mode="" Description="Electricity meter MPAN (auto-discovered if blank)" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  <Config Name="MPRN" Target="MPRN" Default="" Mode="" Description="Gas meter MPRN (auto-discovered if blank)" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  <Config Name="Electricity Serial" Target="ELEC_SERIAL" Default="" Mode="" Description="Electricity meter serial number (auto-discovered if blank)" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  <Config Name="Gas Serial" Target="GAS_SERIAL" Default="" Mode="" Description="Gas meter serial number (auto-discovered if blank)" Type="Variable" Display="advanced" Required="false" Mask="false"/>
  
  <!-- Application Settings -->
  <Config Name="Database URL" Target="DB_URL" Default="sqlite+aiosqlite:////data/octopus.db" Mode="" Description="Database connection string (default: SQLite in /data)" Type="Variable" Display="advanced" Required="false" Mask="false">sqlite+aiosqlite:////data/octopus.db</Config>
  <Config Name="Timezone" Target="TIMEZONE" Default="Europe/London" Mode="" Description="Timezone for data display (UTC used for storage)" Type="Variable" Display="always" Required="false" Mask="false">Europe/London</Config>
  <Config Name="Log Level" Target="LOG_LEVEL" Default="INFO" Mode="" Description="Logging level: DEBUG, INFO, WARNING, ERROR" Type="Variable" Display="advanced" Required="false" Mask="false">INFO</Config>
  <Config Name="Sync Interval" Target="SYNC_INTERVAL_CRON" Default="*/30 * * * *" Mode="" Description="Cron expression for incremental sync (default: every 30 min)" Type="Variable" Display="advanced" Required="false" Mask="false">*/30 * * * *</Config>
  <Config Name="Backfill Days" Target="BACKFILL_DAYS" Default="400" Mode="" Description="Number of days to backfill on first run" Type="Variable" Display="advanced" Required="false" Mask="false">400</Config>
  
  <!-- GraphQL (Experimental) -->
  <Config Name="Enable GraphQL" Target="ENABLE_GRAPHQL" Default="false" Mode="" Description="Enable GraphQL for near-real-time data (requires Home Mini)" Type="Variable" Display="advanced" Required="false" Mask="false">false</Config>
  <Config Name="GraphQL Token" Target="OCTOPUS_GRAPHQL_TOKEN" Default="" Mode="" Description="GraphQL token for Home Mini integration (if enabled)" Type="Variable" Display="advanced" Required="false" Mask="true"/>
</Container>
